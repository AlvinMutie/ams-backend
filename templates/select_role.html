<!DOCTYPE html>
<html>
<head>
    <title>Select Role - AMS</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 50px; }
        .role-option { display: block; width: 100%; padding: 20px; margin: 10px 0; border: 2px solid #ddd; cursor: pointer; }
        .role-option:hover { border-color: #1e4d2b; }
        .continue-btn { padding: 15px; background: #1e4d2b; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Welcome, {{ user.name }}!</h1>
    <p>Please select your role:</p>
    
    <form id="roleForm">
        <button type="button" class="role-option" data-role="student">Student</button>
        <button type="button" class="role-option" data-role="industry_supervisor">Industry Supervisor</button>
        <button type="button" class="role-option" data-role="school_supervisor">School Supervisor</button>
        <button type="button" class="role-option" data-role="admin">Administrator</button>
        
        <button type="submit" class="continue-btn" id="continueBtn" disabled>Continue</button>
    </form>

    <script>
        let selectedRole = null;
        
        document.querySelectorAll('.role-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.role-option').forEach(opt => opt.style.borderColor = '#ddd');
                this.style.borderColor = '#1e4d2b';
                selectedRole = this.dataset.role;
                document.getElementById('continueBtn').disabled = false;
            });
        });
        
        document.getElementById('roleForm').addEventListener('submit', function(e) {
            e.preventDefault();
            if (!selectedRole) return;
            
            fetch('/api/set-role', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ role: selectedRole })
            })
            .then(response => response.json())
            .then(data => {
                if (data.message === 'Role set successfully') {
                    const role = data.role;
                    if (role === 'student') window.location.href = '/student';
                    else if (role === 'industry_supervisor') window.location.href = '/industry';
                    else if (role === 'school_supervisor') window.location.href = '/supervisor';
                    else if (role === 'admin') window.location.href = '/admin';
                }
            });
        });
    </script>
</body>
</html>
